# 2022-1 í•™ê¸° ë°ì´í„°ë§ˆì´ë‹ í”„ë¡œì íŠ¸_(8)  

ğŸ ì €ë²ˆ ê¸€ì— ì´ì–´ ì—¬ëŸ¬ ê°€ì§€ Null invariant measureë“¤ì„ í†µí•´ attribute ê°„ì˜ ê´€ê³„ë¥¼ ì•Œì•„ë³´ë„ë¡ í•˜ì.<br>    

***  

## 1. Null Invariant Measure ë°ì´í„°í”„ë ˆì„ ìƒì„±  

ğŸ“Œ <b>chi-square, p-value</b> ê³„ì‚°  

```py
# chi-square ê³„ì‚°(transaction dataframe ê¸°ì¤€ : ê° attributeì˜ category)
# scipy.statsì˜ chi2_contingencyë¥¼ í†µí•´ì„œ contingency table ìƒì„±.
# contingency tableì„ ë°”íƒ•ìœ¼ë¡œ chi-squareì™€ p-value ê³„ì‚°.
chi_list = pd.DataFrame()
from scipy.stats import chi2_contingency
for i in range(len(transaction.columns)):
    f=transaction.columns[i]
    contigency = pd.crosstab(transaction[f],transaction['Cardio'])
    chi, p, dof, expected = chi2_contingency(contigency)
    chi_list = chi_list.append((pd.DataFrame({'chi' :chi, 'p-value':p}, index = [transaction.columns[i]+" & cardio"])))
```  

ğŸ“Œ <b>support ê³„ì‚°</b>  

```py
# support ê³„ì‚° í•¨ìˆ˜
# transaction dataì™€ itemì„ parameterë¡œ ë°›ìŒ
# itemì´ list í˜•íƒœë©´ ê·¸ëŒ€ë¡œ itemì„ ë°˜í™˜í•˜ë©°, listê°€ ì•„ë‹ˆë©´ list í˜•íƒœë¡œ ë°”ê¿”ì„œ items_listë¡œ ë°˜í™˜í•¨ - sum()ì—°ì‚°
# transaction dataì—ì„œ item_listì˜ attributeë¥¼ ë°›ì•„ columnê¸°ì¤€ sum ì—°ì‚° ìˆ˜í–‰. 
# ë³€ìˆ˜ a : ìœ„ì˜ sum ì—°ì‚°ê²°ê³¼ê°€ items_listì˜ ê¸¸ì´ì™€ ê°™ì€ rowì˜ ê°œìˆ˜, ì¦‰ í•´ë‹¹í•˜ëŠ” items_listì˜ ìš”ì†Œë¥¼ ëª¨ë‘ ê°€ì§€ê³  ìˆëŠ” rowì˜ ê°œìˆ˜ë¥¼ sum()
# ì´ë¥¼ ì „ì²´ transaction ìˆ˜(ë³€ìˆ˜ b)ë¡œ ë‚˜ëˆ ì„œ í•´ë‹¹ item ì§‘í•©ì´ ë°œìƒí•œ í™•ë¥ ì„ êµ¬í•¨.
def support(transaction, item): 
    items_list = item if isinstance(item,list) else list(item)
    a = np.sum(transaction.loc[:,items_list].sum(axis=1)==len(items_list)) 
    b = transaction.loc[:,items_list].shape[0]
    return a/b
```  

ğŸ“Œ <b>Jaccard, Kulczynski, IR ê³„ì‚°</b>  

```py
# ìœ„ì—ì„œ ë§Œë“  support í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ì§‘í•© X, ì§‘í•© Y, êµì§‘í•©ì˜ supportë¥¼ êµ¬í•´ì„œ metric ê³µì‹ì— ëŒ€ì….
# ì–»ì€ ê²°ê³¼ê°’ì„ dataframeí˜•íƒœë¡œ ë³€í™˜
Null_inv = pd.DataFrame()
for i in range(len(transaction.columns)):
    rslt01 = support(transaction, [transaction.columns[i]])
    rslt02 = support(transaction, ['Cardio'])
    rslt03 = support(transaction, (transaction.columns[i],'Cardio'))
    
    jacc = rslt03 / (rslt01+rslt02-rslt03)
    kulc = (0.5)*((rslt03/rslt01) + (rslt03/rslt02)) 
    ir = abs((rslt01 - rslt02)) / (rslt01+rslt02-rslt03)

    Null_inv = Null_inv.append((pd.DataFrame({'Jaccard' :jacc, 'kulczynski' :kulc, 'IR' : ir}, index = [transaction.columns[i]+" & cardio"])))
```  

ğŸ“Œ ë°ì´í„°í”„ë ˆì„ ìƒì„±  

```py
# chi-squareì™€ p-value, jaccard, kulczynski, IRì„ í•˜ë‚˜ì˜ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ í†µí•© - Null_inv
Null_inv = pd.merge(Null_inv, chi_list, how = 'outer', left_index=True, right_index=True)
Null_inv = Null_inv.drop(['Cardio & cardio', 'No_cardio & cardio'], axis = 0)

# kulczynskië¥¼ ê¸°ì¤€ìœ¼ë¡œ í° ìˆœì„œë¶€í„° ë‚˜ì—´
Null_inv = Null_inv.sort_values('kulczynski', ascending = False)
Null_inv
```  
<p align="center"><img src="https://user-images.githubusercontent.com/65170165/192140866-a8b850c5-4b6a-49ab-ae05-2fcc5190e5cb.png" width="600" /></p><br>  

ğŸ ì´ë ‡ê²Œ í•´ì„œ ìµœì¢… ê°’ë“¤ì„ ëª¨ë‘ êµ¬í–ˆëŠ”ë°, ìˆ«ìë„ ë„ˆë¬´ ë³µì¡í•˜ê³  ê·¸ í¬ê¸°ë¥¼ ë¹„êµí•˜ê¸°ë„ í˜ë“¤ë‹¤. ë”°ë¼ì„œ ì´ ì¤‘ì—ì„œ ê°€ì¥ ë°ì´í„°ë¥¼ ì˜ í‘œí˜„í•˜ê¸°ë¡œ ì•Œë ¤ì§„ kulczynskiì™€ IRì„ ì‹œê°í™”í•´ì„œ attribute ê°„ì˜ ê´€ê³„ë¥¼ ë¶„ì„í•  ê²ƒì´ë‹¤.<br>  

***  

## 2. ì‹œê°í™”  

```py
# ì‹œê°í™”ë¥¼ ìœ„í•œ plotly library ì„í¬íŠ¸
import plotly.graph_objects as go
import plotly.offline as pyo
pyo.init_notebook_mode()

# Transaction Dataì˜ Attribute-Cardio ë³„ Kulczynski / IR ê°’ ì‹œê°í™”
fig = go.Figure()
fig.add_trace(
    go.Scatter(
    x = Null_inv.index, y = Null_inv['IR'], mode = 'markers+lines+text', name = 'IR'))

fig.add_trace(
    go.Scatter(
    x = Null_inv.index, y = Null_inv['kulczynski'], mode = 'markers+lines+text', name = 'Kulczynski'))

fig.update_layout(
    {
        'title' : {'text':'Attribute-Cardio ë³„ Kulczynski / IR ê°’', 'font':{'size' : 25}},
        'template' : 'plotly_white'
    })

fig.add_hline(y=0.5, line_dash="dot",
              line_color = "#ff0000",
              annotation_text="Kulczynski = 0.5", 
              annotation_position="bottom right",
              annotation_font_size=17,
              annotation_font_color="black"
             )

fig.show()
```  

<p align="center"><img src="https://user-images.githubusercontent.com/65170165/171839022-48234143-5a11-4d49-8e07-cc5f85b7bf29.png" width="1800" /></p><br>  

***  

## 3. Null-Invariant Measures ê²°ê³¼  

- kulczynski, IR, chi-square ê°’ìœ¼ë¡œ ëª‡ê°€ì§€ ìœ ì¶”ê°€ ê°€ëŠ¥í•˜ë‹¤.  
  - (1) 30 & cardio : kulczynski = 0.109444, IR = 0.980692, chi-square = 111.024261 ì´ë¯€ë¡œ ë‘˜ì˜ ê´€ê³„ëŠ” negativeí•˜ë©°, ë‘ ì§‘í•©ì˜ ë¶„í¬ê°€ imbalanced í•˜ë‹¤.  
  - (2) HBP_SYS & cardio : kulczynski = 0.640039, IR = 0.431196, chi-square = 10586.494635 ì´ë¯€ë¡œ ë‘˜ì˜ ê´€ê³„ëŠ” positiveí•˜ê³ , ë‘ ì§‘í•©ì˜ ë¶„í¬ ì—­ì‹œ ì–´ëŠì •ë„ ê³ ë¥´ë‹¤.<br>  
    
- kulczynskiì˜ ê²°ê³¼ê°€ 0.5ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚˜ë‰˜ê³ , ê·¸ì— ë”°ë¥¸ IRë¡œë¶€í„° ëª‡ê°€ì§€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.  
  - ì´ë•Œ IRì˜ ê°’ì´ í•˜ë‚˜ì˜ categroyê°€ ê°€ì§€ëŠ” ê°’ì— ëŒ€í•´ì„œ ë‹¤ì–‘í•˜ê²Œ ë‚˜ì˜¤ê³  ìˆìœ¼ë¯€ë¡œ, ì§‘í•©ë“¤ ì‚¬ì´ì˜ ë¶„í¬ê°€ ê³ ë¥´ì§€ ì•Šì€ ê²½ìš°ê°€ ë§ìŒì„ ì•Œ ìˆ˜ ìˆìŒ.  
  - ë”°ë¼ì„œ ì „ì²´ ë°ì´í„° í¬ê¸°ì— ëŒ€í•œ ë¶„í¬ì˜ ì˜í–¥(e.x. BMI -> HIGH_OBESITY)ì„ ë°°ì œí•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— kulczynskiì™€ IR ê°’ë§Œìœ¼ë¡œ attributeë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì€ ì–´ë ¤ì›€.  
  - ê·¸ëŸ¼ì—ë„ ì¼ë‹¨ kulczynskiì™€ IR ê°’ìœ¼ë¡œ ì„ íƒí•œ attributeëŠ” ë‹¤ìŒê³¼ ê°™ìŒ.  
  - [ap_hi, ap_lo, gluc, gender, active, age, cholesterol]  
    
- ì „ì²´ì ìœ¼ë¡œ í° chi-squareê°’ì„ ë³´ì´ë‚˜, ê·¸ì— ë¹„í•´ ì‘ì€ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” attributeë¥¼ ì œì™¸í•˜ë©´ ë‚¨ì€ attributeëŠ” ì•„ë˜ì™€ ê°™ìŒ.  
  - [age, ap_hi, ap_lo, cholesterol, gluc, active, BMI]<br>  
  
***  

ğŸ ì´ë ‡ê²Œ í•´ì„œ Null-invariant measureë¥¼ í†µí•´ ë°ì´í„°ì˜ íŒ¨í„´ì„ íŒŒì•…í•´ ë³´ì•˜ë‹¤. ì‚¬ì‹¤ ì´ ê°’ë“¤ì˜ í¬ê¸°ë¥¼ í†µí•´ ê´€ê³„ë¥¼ íŒŒì•…í•˜ëŠ” ë°ì—ëŠ” ì ˆëŒ€ì ì¸ ê¸°ì¤€ì¹˜ê°€ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ë°ì´í„°ì˜ attributeë“¤ ì‚¬ì´ì˜ ê°’ë“¤ë§Œ ìƒëŒ€í‰ê°€í•´ì„œ íŒ¨í„´ì„ ë¶„ì„í•˜ì˜€ë‹¤.<br>  

ğŸ ì•„ë¬´ë˜ë„ ìƒëŒ€ì ì¸ ê°’ë“¤ì„ í†µí•´ ê·¸ ê´€ê²Œë¥¼ ë¹„êµí•  ê²ƒì´ê¸° ë•Œë¬¸ì— ì•„ì£¼ ì •í™•í•œ íŒ¨í„´ì´ë¼ê³  ë§í•˜ê¸°ëŠ” ì–´ë µê² ì§€ë§Œ, ì¼ë‹¨ì€ ì´ë ‡ê²Œ ë‚˜ì˜¨ ê°’ë“¤ê³¼ ê´€ê³„ë¥¼ ê°€ì§€ê³  í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ê²ƒì´ë‹¤.<br>  

ğŸ ë‹¤ìŒ ê¸€ì—ì„œëŠ” PCA, ì¦‰ ì£¼ì„±ë¶„ ë¶„ì„ì„ ê°€ì§€ê³  ë°ì´í„°ë¥¼ ë¶„ì„í•´ ë³´ì.  

***  
